if (self.CavalryLogger) { CavalryLogger.start_js(["YA3Dt"]); }

__d("LSVersion.bs",["gkx","LSVersion","LSSecureVersion","MessengerWebSyncScripts"],(function(a,b,c,d,e,f){"use strict";a=b("gkx")("1671170")?b("LSSecureVersion"):b("LSVersion");c=b("MessengerWebSyncScripts").schemaVersionV2;d=c==null?a:c;f.version=d}),null);
__d("LSDict",["invariant","nativePromiseRegeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";e.exports=i;function h(a){a.tag="ls-array";return a}function i(a){var c=this,d=new Map([].concat(a||[]).map(function(a){var b=a[0];a=a[1];return[JSON.stringify(b),a]}));this.get=function(a){return d.get(JSON.stringify(a))};this.set=function(a,b){d.set(JSON.stringify(a),b);return c};this["delete"]=function(a){return d["delete"](JSON.stringify(a))};this.clear=function(){return d.clear()};this.forEach=function(a,b){return d.forEach(function(b,d){return a(b,JSON.parse(d),c)},b)};this._getSize=function(){return d.size};Object.defineProperties(this,{size:{get:function(){return d.size}}});this.has=function(a){return d.has(JSON.stringify(a))};this.entries=b("nativePromiseRegeneratorRuntime").mark(function a(){var c,e,f,g,h,i,j;return b("nativePromiseRegeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:c=d.entries(),e=Array.isArray(c),f=0,c=e?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();case 1:if(!e){a.next=7;break}if(!(f>=c.length)){a.next=4;break}return a.abrupt("break",18);case 4:g=c[f++];a.next=11;break;case 7:f=c.next();if(!f.done){a.next=10;break}return a.abrupt("break",18);case 10:g=f.value;case 11:h=g;i=h[0];j=h[1];a.next=16;return[JSON.parse(i),j];case 16:a.next=1;break;case 18:case"end":return a.stop()}},a,this)});this[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]=this.entries;this.keys=function(){return h(Array.from(d.keys()).map(function(a){return JSON.parse(a)}))};this.values=d.values.bind(d)}i.fromObject=function(a){return new i(Object.entries(a))};i.shapeToRecord=function(a){return Array.from(a).reduce(function(a,b){var c=b[0];b=b[1];typeof c==="string"||g(0,22198);return babelHelpers["extends"]({},a,(a={},a[c]=b,a))},{})}}),null);
__d("LSJson",["bs_caml_int64","LSDict","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";f.stringify=h;var g=512;function h(a,c){c===void 0&&(c=0);if(c>g)throw b("unrecoverableViolation")("recursion limit exceeded","messenger_comet");if(typeof a==="string"||typeof a==="number"||typeof a==="boolean")return JSON.stringify(a);else if(a===void 0)return"null";else if(typeof a==="object")if(Array.isArray(a))return a.tag==="ls-array"?"["+a.map(function(a){return h(a,c+1)}).join(",")+"]":b("bs_caml_int64").to_string(a);else if(a instanceof b("LSDict"))return"{"+Array.from(a.entries()).map(function(a){var d=a[0];a=a[1];if(typeof d==="string")return JSON.stringify(d)+":"+h(a,c+1);else throw b("unrecoverableViolation")("key must be a string","messenger_comet")}).join(",")+"}";throw b("unrecoverableViolation")("type not supported: %s"+typeof a,"messenger_comet")}}),null);
__d("LSRequestType.bs",[],(function(a,b,c,d,e,f){"use strict";a=[0,1];b=[0,2];c=[0,3];d=[0,4];f.initSync=a;f.resumeSync=b;f.taskBatch=c;f.fireForget=d}),null);
__d("LSSyncChannel.bs",[],(function(a,b,c,d,e,f){"use strict";a=[0,1];b=[0,2];f.realtime=a;f.http=b}),null);
__d("XLightSpeedWebRequestController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messaging/lightspeedweb/request/",{device_id:{type:"String",required:!0},request_id:{type:"Int",required:!0},request_type:{type:"Int"},request_payload:{type:"String"}})}),null);
__d("LSMailboxInitialSyncRequest.bs",["bs_curry","bs_int64","bs_js_dict","LSVersion.bs","bs_caml_int64","bs_belt_Option","LSRequestType.bs","LSSyncChannel.bs","cometAsyncFetch","bs_js_null_undefined","MessengerWebRegion","MessengerWebSyncScripts","XLightSpeedWebRequestController"],(function(a,b,c,d,e,f){"use strict";var g=function(){return Array.from(crypto.getRandomValues(new Uint32Array(2)))},h={contents:void 0},i={contents:b("LSSyncChannel.bs").realtime},j={contents:0};function a(){var a;j.contents=Date.now();h.contents=(a=b("bs_caml_int64")).and_(a.or_(a.lsl_(a.of_float(Date.now()),22),a.and_(b("bs_curry")._1(g,0),[0,4194303])),[2147483647,4294967295]);i.contents=b("LSSyncChannel.bs").http;var c=b("bs_js_null_undefined").fromOption(JSON.stringify({database:1,version:b("LSVersion.bs").version,epoch_id:b("bs_js_null_undefined").fromOption(b("bs_belt_Option").map(h.contents,b("bs_int64").to_string)),last_applied_cursor:null,failure_count:null,sync_params:b("bs_js_null_undefined").fromOption(JSON.stringify({scale:1,preview_height:200,full_height:200}))}));return b("cometAsyncFetch")(b("XLightSpeedWebRequestController").getURIBuilder().setString("device_id",b("MessengerWebSyncScripts").deviceId).setInt("request_id",0).setInt("request_type",a.to_int32(b("LSRequestType.bs").initSync)).setString("request_payload",c).getURI().toString(),{method:"POST",requestHeaders:b("bs_js_dict").fromArray([["X-MSGR-Region",b("MessengerWebRegion").region]]),data:{}})}f.epochId=h;f.syncChannel=i;f.lastSyncTimestampMs=j;f.send=a}),null);
__d("LSDbStorage",["invariant","IndexedDbKeyComparer","LSStorage","bs_caml_int64","nativePromiseRegeneratorRuntime","nullthrows","BPlusTreeBase"],(function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h=function(a){return b("BPlusTreeBase")(b("IndexedDbKeyComparer"),16,a)};function i(a){Array.isArray(a)&&a.length===2&&a.every(Number.isInteger)||g(0,21993);return b("bs_caml_int64").to_float(a)}function j(a,b){function c(b){if(b.done)return b.value;b.value instanceof Promise||g(0,22157);return b.value.then(function(b){return c(a.next(b))})}return c(a.next(b))}function k(a){return{next:b("nativePromiseRegeneratorRuntime").mark(function c(d){var e;return b("nativePromiseRegeneratorRuntime").wrap(function(b){while(1)switch(b.prev=b.next){case 0:e=a.next(d);case 1:if(!(e.value instanceof window.Promise)){b.next=9;break}b.t0=a;b.next=5;return e.value;case 5:b.t1=b.sent;e=b.t0.next.call(b.t0,b.t1);b.next=1;break;case 9:return b.abrupt("return",e);case 10:case"end":return b.stop()}},c,this)})}}function l(a){var b=k(a);return{next:function(a){function b(b){return a.apply(this,arguments)}b.toString=function(){return a.toString()};return b}(function(a){return j(b.next(a))})}}function a(a,c){var d={},e=b("LSStorage").createSubscriptionManager(b("IndexedDbKeyComparer"),c),f=b("LSStorage").searchKey.bind(null,c);function m(b){return(b.has(d)?b:b.set(d,a.createTransaction())).get(d)}function n(a,d,e,i){var k,l,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I;return b("nativePromiseRegeneratorRuntime").async(function(J){while(1)switch(J.prev=J.next){case 0:k=m(a);l=k.table(d);n=h(l);o=c.tableNames[d];p=b("nullthrows")(f(d,e));q=Object.keys(o.indexes).reduce(function(b,c){var a=f(d,e,c);a!=null&&(b[c]=a);return b},{});r={};J.next=9;return b("nativePromiseRegeneratorRuntime").awrap(j(n.getWithDefault(p,void 0)));case 9:s=J.sent;if(!(s!==void 0)){J.next=20;break}if(!Object.keys(o.indexes).length){J.next=16;break}J.next=14;return b("nativePromiseRegeneratorRuntime").awrap(j(l.readDataExn(s,i,a)));case 14:t=J.sent,r=Object.keys(o.indexes).reduce(function(b,c){var a=f(d,t,c);a!=null&&(b[c]=a);return b},{});case 16:J.next=18;return b("nativePromiseRegeneratorRuntime").awrap(j(l.writeData(s,e,i,a)));case 18:J.next=26;break;case 20:o.autoIncrement&&g(0,21990);J.next=23;return b("nativePromiseRegeneratorRuntime").awrap(j(l.writeNewData(e,i,a)));case 23:s=J.sent;J.next=26;return b("nativePromiseRegeneratorRuntime").awrap(j(n.set(p,s)));case 26:u=Object.keys(q);for(v=0;v<u.length;v++)w=u[v],r[w]!==void 0&&b("IndexedDbKeyComparer")(r[w],q[w])===0&&(delete q[w],delete r[w]);x=Object.keys(q);y=0;case 30:if(!(y<x.length)){J.next=41;break}z=x[y];A=h(l.index(z));J.next=35;return b("nativePromiseRegeneratorRuntime").awrap(j(A.has(q[z])));case 35:J.t0=!J.sent;if(J.t0){J.next=38;break}g(0,21996,d,z);case 38:y++;J.next=30;break;case 41:B=Object.keys(q),C=0;case 43:if(!(C<B.length)){J.next=51;break}D=B[C];E=h(l.index(D));J.next=48;return b("nativePromiseRegeneratorRuntime").awrap(j(E.set(q[D],s)));case 48:C++;J.next=43;break;case 51:F=Object.keys(r),G=0;case 53:if(!(G<F.length)){J.next=61;break}H=F[G];I=h(l.index(H));J.next=58;return b("nativePromiseRegeneratorRuntime").awrap(j(I["delete"](r[H])));case 58:G++;J.next=53;break;case 61:case"end":return J.stop()}},null,this)}function o(a,d,e,g){var i,k,l,n,o,p,q,r,s,t,u;return b("nativePromiseRegeneratorRuntime").async(function(v){while(1)switch(v.prev=v.next){case 0:i=m(a);k=i.table(d);l=h(k);n=c.tableNames[d];v.next=6;return b("nativePromiseRegeneratorRuntime").awrap(j(l.getWithDefault(e,void 0)));case 6:o=v.sent;if(!(o!==void 0)){v.next=28;break}if(!Object.keys(n.indexes).length){v.next=24;break}v.next=11;return b("nativePromiseRegeneratorRuntime").awrap(j(k.readDataExn(o,g,a)));case 11:p=v.sent,q=Object.keys(n.indexes),r=0;case 14:if(!(r<q.length)){v.next=24;break}s=q[r];t=f(d,p,s);if(!(t!=null)){v.next=21;break}u=h(k.index(s));v.next=21;return b("nativePromiseRegeneratorRuntime").awrap(j(u["delete"](t)));case 21:r++;v.next=14;break;case 24:v.next=26;return b("nativePromiseRegeneratorRuntime").awrap(j(l["delete"](e)));case 26:v.next=28;return b("nativePromiseRegeneratorRuntime").awrap(j(k.remove(o)));case 28:case"end":return v.stop()}},null,this)}function p(a,d,e,k){var l,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C;return b("nativePromiseRegeneratorRuntime").async(function(D){while(1)switch(D.prev=D.next){case 0:l=m(a);n=l.table(d);o=h(n);p=c.tableNames[d];q=f(d,e);if(!p.autoIncrement){D.next=14;break}r=e[c.tableNames[d].primaryKeyIds[0]];D.t0=b("bs_caml_int64");D.next=10;return b("nativePromiseRegeneratorRuntime").awrap(n.incrementSeed(r===void 0?r:i(r)));case 10:D.t1=D.sent,D.t2=D.t0.of_float.call(D.t0,D.t1),q=[D.t2,0],e[c.tableNames[d].primaryKeyIds[0]]=q[0];case 14:if(!(q==null)){D.next=16;break}throw new Error("Evaluating the object store's key path did not yield a value");case 16:D.next=18;return b("nativePromiseRegeneratorRuntime").awrap(j(o.has(q)));case 18:if(D.sent){D.next=51;break}s=Object.keys(p.indexes);t=0;case 21:if(!(t<s.length)){D.next=34;break}u=s[t];v=f(d,e,u);if(!(v!=null)){D.next=31;break}w=h(n.index(u));D.next=28;return b("nativePromiseRegeneratorRuntime").awrap(j(w.has(v)));case 28:D.t3=!D.sent;if(D.t3){D.next=31;break}g(0,21996,d,u);case 31:t++;D.next=21;break;case 34:D.next=36;return b("nativePromiseRegeneratorRuntime").awrap(j(n.writeNewData(e,k,a)));case 36:x=D.sent;D.next=39;return b("nativePromiseRegeneratorRuntime").awrap(j(o.set(q,x)));case 39:y=Object.keys(p.indexes),z=0;case 41:if(!(z<y.length)){D.next=51;break}A=y[z];B=f(d,e,A);if(!(B!=null)){D.next=48;break}C=h(n.index(A));D.next=48;return b("nativePromiseRegeneratorRuntime").awrap(j(C.set(B,x)));case 48:z++;D.next=41;break;case 51:case"end":return D.stop()}},null,this)}var q;return q={getTableData:function(){return c},flushWrites:function(c){var g,h,i,j,k,l,m,r,s,t;return b("nativePromiseRegeneratorRuntime").async(function(u){while(1)switch(u.prev=u.next){case 0:if(!(c.length===0)){u.next=2;break}return u.abrupt("return");case 2:g=a.createTransaction(),h=new WeakMap([[d,g]]),(i=c,j=Array.isArray(i),k=0,i=j?i:i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 5:if(!j){u.next=11;break}if(!(k>=i.length)){u.next=8;break}return u.abrupt("break",34);case 8:l=i[k++];u.next=15;break;case 11:k=i.next();if(!k.done){u.next=14;break}return u.abrupt("break",34);case 14:l=k.value;case 15:m=l;r=m[0];s=m[1];t=m[2];if(!(s!=null&&t!=null&&b("LSStorage").areKeysEqual(b("nullthrows")(f(r,s)),b("nullthrows")(f(r,t))))){u.next=24;break}u.next=22;return b("nativePromiseRegeneratorRuntime").awrap(n(h,r,t,q));case 22:u.next=30;break;case 24:if(!(s!=null)){u.next=27;break}u.next=27;return b("nativePromiseRegeneratorRuntime").awrap(o(h,r,b("nullthrows")(f(r,s)),q));case 27:if(!(t!=null)){u.next=30;break}u.next=30;return b("nativePromiseRegeneratorRuntime").awrap(p(h,r,t,q));case 30:u.next=32;return b("nativePromiseRegeneratorRuntime").awrap(e.notifyTableAndIndexSubscribers(r,s,t,h));case 32:u.next=5;break;case 34:e.notifyCommit();case 35:case"end":return u.stop()}},null,this)},subscribeToCommit:function(a){return e.subscribeToCommit(a)},table:function(d){return{get:function(a,c){var e,f,g,i;return b("nativePromiseRegeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:c===void 0&&(c=new WeakMap());e=m(c);f=e.table(d);g=h(f);k.next=6;return b("nativePromiseRegeneratorRuntime").awrap(j(g.getWithDefault(a,void 0)));case 6:i=k.sent;if(!(i===void 0)){k.next=9;break}return k.abrupt("return",void 0);case 9:return k.abrupt("return",j(f.readDataExn(i,q,c)));case 10:case"end":return k.stop()}},null,this)},entries:function(a,c,e){c===void 0&&(c="asc");e===void 0&&(e={});return l(b("nativePromiseRegeneratorRuntime").mark(function f(){var g,i,j,l,n,o,p,r;return b("nativePromiseRegeneratorRuntime").wrap(function(b){while(1)switch(b.prev=b.next){case 0:g=m(a);i=g.table(d);j=h(i);l=k(j.entries(babelHelpers["extends"]({},e,{dir:c})));return b.delegateYield(l.next(),"t0",5);case 5:n=b.t0;case 6:if(n.done){b.next=19;break}o=n.value,p=o[0],r=o[1];b.t1=l;b.t2=p;return b.delegateYield(i.readDataExn(r,q,a),"t3",11);case 11:b.t4=b.t3;b.next=14;return[b.t2,b.t4];case 14:b.t5=b.sent;return b.delegateYield(b.t1.next.call(b.t1,b.t5),"t6",16);case 16:n=b.t6;b.next=6;break;case 19:case"end":return b.stop()}},f,this)})())},peekNextAutoIncrementId:function(){var e,f;return b("nativePromiseRegeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:e=c.tableNames[d].autoIncrement;e||g(0,19732);h.next=4;return b("nativePromiseRegeneratorRuntime").awrap(a.createTransaction().table(d).readSeed());case 4:f=h.sent;f!==void 0||g(0,19733);return h.abrupt("return",b("bs_caml_int64").of_float(f));case 7:case"end":return h.stop()}},null,this)},subscribe:function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return e.subscribeTable.apply(e,[d].concat(b))},index:function(a){var i;return i={get:function(e,f){var g,i,c,k;return b("nativePromiseRegeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:f===void 0&&(f=new WeakMap());g=m(f);i=g.table(d);c=h(i.index(a));l.next=6;return b("nativePromiseRegeneratorRuntime").awrap(j(c.getWithDefault(e,void 0)));case 6:k=l.sent;if(!(k===void 0)){l.next=9;break}return l.abrupt("return",void 0);case 9:return l.abrupt("return",j(i.readDataExn(k,q,f)));case 10:case"end":return l.stop()}},null,this)},getKey:function(a){var c;return b("nativePromiseRegeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("nativePromiseRegeneratorRuntime").awrap(i.get(a));case 2:c=e.sent;if(!(c===void 0)){e.next=5;break}return e.abrupt("return",void 0);case 5:return e.abrupt("return",f(d,c));case 6:case"end":return e.stop()}},null,this)},entries:function(e,f,i){f===void 0&&(f="asc");i===void 0&&(i={});return l(b("nativePromiseRegeneratorRuntime").mark(function j(){var n,o,l,p,r,s,t,u,v;return b("nativePromiseRegeneratorRuntime").wrap(function(b){while(1)switch(b.prev=b.next){case 0:n=m(e);o=n.table(d);l=h(o.index(a));p=c.tableNames[d].indexes[a].unique;p||g(0,19850);r=k(l.entries(babelHelpers["extends"]({},i,{dir:f})));return b.delegateYield(r.next(),"t0",7);case 7:s=b.t0;case 8:if(s.done){b.next=21;break}t=s.value,u=t[0],v=t[1];b.t1=r;b.t2=u;return b.delegateYield(o.readDataExn(v,q,e),"t3",13);case 13:b.t4=b.t3;b.next=16;return[b.t2,b.t4];case 16:b.t5=b.sent;return b.delegateYield(b.t1.next.call(b.t1,b.t5),"t6",18);case 18:s=b.t6;b.next=8;break;case 21:case"end":return b.stop()}},j,this)})())},subscribe:function(){for(var b=arguments.length,c=new Array(b),f=0;f<b;f++)c[f]=arguments[f];return e.subscribeIndex.apply(e,[d,a].concat(c))}}}}}}}}),null);
__d("MemoryDbStore",["invariant","regeneratorRuntime","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";e.exports=a;function h(b){if(b==null)return b;var c=Object.getOwnPropertyNames(b),a={},d,e;for(d=0;d<c.length;d++)e=b[c[d]],a[c[d]]=Array.isArray(e)?[].concat(e):e;return a}function i(){var a,c={},d=void 0,e=0;return{read:(a=b("regeneratorRuntime")).mark(function a(d){return b("regeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:return a.abrupt("return",c[d]);case 1:case"end":return a.stop()}},a,this)}),readDataExn:a.mark(function a(d){return b("regeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:return a.abrupt("return",c[d]!==void 0?h(c[d]):g(!1,"expected key"));case 1:case"end":return a.stop()}},a,this)}),readExn:a.mark(function a(d){return b("regeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:return a.abrupt("return",c[d]!==void 0?c[d]:g(!1,"expected key"));case 1:case"end":return a.stop()}},a,this)}),readHeader:a.mark(function a(){return b("regeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:return a.abrupt("return",d);case 1:case"end":return a.stop()}},a,this)}),remove:a.mark(function a(d){return b("regeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:delete c[d];case 1:case"end":return a.stop()}},a,this)}),write:a.mark(function a(d,e){return b("regeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:c[d]=e;case 1:case"end":return a.stop()}},a,this)}),writeData:a.mark(function a(d,e){return b("regeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:c[d]=h(e);case 1:case"end":return a.stop()}},a,this)}),writeHeader:a.mark(function a(c){return b("regeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:d=c;case 1:case"end":return a.stop()}},a,this)}),writeNew:a.mark(function a(d){return b("regeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:c[e++]=d;return a.abrupt("return",e-1);case 2:case"end":return a.stop()}},a,this)}),writeNewData:a.mark(function a(d){return b("regeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:c[e++]=h(d);return a.abrupt("return",e-1);case 2:case"end":return a.stop()}},a,this)})}}function j(a,c,d){return b("nullthrows")((a.has(c)?a:a.set(c,d())).get(c))}function a(){var a=new Map();return{createTransaction:function(){return{table:function(c){var d=j(a,c,function(){return{indexes:new Map(),seed:0}});return babelHelpers["extends"]({},j(d.indexes,"",i),{incrementSeed:function(a){return b("regeneratorRuntime").async(function(b){while(1)switch(b.prev=b.next){case 0:if(!(a===void 0)){b.next=2;break}return b.abrupt("return",d.seed++);case 2:d.seed=Math.max(d.seed,a)+1;return b.abrupt("return",a);case 4:case"end":return b.stop()}},null,this)},index:function(a){return j(d.indexes,a,i)},readSeed:function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:return a.abrupt("return",d.seed);case 1:case"end":return a.stop()}},null,this)}})}}}}}}),null);
__d("LSJSTestMemoryStorage.bs",["LSDbStorage","MemoryDbStore"],(function(a,b,c,d,e,f){"use strict";function a(a){return b("LSDbStorage")(b("MemoryDbStore")(),a)}f.make=a}),null);
__d("LSTransaction",["invariant","BPlusTree","LSStorage","bs_caml_int64","err","nativePromiseRegeneratorRuntime","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";var h=b("LSStorage").createSubscriptionManager,i=b("LSStorage").areKeysEqual,j=new WeakMap(),k={};function l(a,c,d,e){d=b("err")("Unique Constraint Error encountered "+a+" to "+c);return d}function m(b){if(b==null)return b;var c=Object.getOwnPropertyNames(b),a={},d,e;for(d=0;d<c.length;d++)e=b[c[d]],a[c[d]]=Array.isArray(e)?[].concat(e):e;return a}function n(a){j.has(a)||j.set(a,JSON.stringify([].concat(a).sort()));return j.get(a)}var o=Promise.resolve(),p=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.call(this,"Transaction has finished")||this}return a}(babelHelpers.wrapNativeSuper(Error));e.exports=function(a,c,d,e){var f=b("nativePromiseRegeneratorRuntime").mark(B),j=[],q=a.getTableData(),r=h(c,q),s=b("LSStorage").searchKey.bind(null,q),t=Object.keys(q.tableNames).reduce(function(a,b){var c=q.tableNames[b];a[b]=Object.keys(c.indexes).map(function(a){return c.indexes[a]}).filter(function(a){a=a.keyIds;return n(a)!==n(c.primaryKeyIds)});return a},{}),u=function(a){},v=new Promise(function(a,b){u=function(a){w=!0;b(a);throw a}}),w=!1,x=new Map();function y(d){var e=x.get(d);if(e===void 0){var f=b("BPlusTree")(c),h=Object.keys(q.tableNames[d].indexes).reduce(function(a,d){a[d]=b("BPlusTree")(c);return a},{}),i;e={entities:f,getWithDefault:function(a){return f.getWithDefault(a,void 0)},indexes:h,nextAutoIncrementId:function(){return b("nativePromiseRegeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:q.tableNames[d].autoIncrement||g(0,19734);i===void 0?i=a.table(d).peekNextAutoIncrementId():i=i.then(function(a){a=b("bs_caml_int64").add(b("bs_caml_int64").one,a);return a});return c.abrupt("return",i);case 3:case"end":return c.stop()}},null,this)},set:function(a,b,c){if(c!=null){var e=Object.keys(h);for(var g=0;g<e.length;g++){var i=e[g],j=s(d,c,i);j!=null&&h[i].set(j,void 0)}}f.set(a,b);if(b.value!=null){i=Object.keys(h);for(var j=0;j<i.length;j++){e=i[j];g=s(d,b.value,e);g!=null&&h[e].set(g,b)}}return b}};x.set(d,e)}return e}function z(d,e,f){var g,h,i,j,l,m,o,p,r,t,u;return b("nativePromiseRegeneratorRuntime").async(function(v){while(1)switch(v.prev=v.next){case 0:g=q.tableNames[d].indexes,h=new Set(),i=y(d),j=Object.keys(g),l=0;case 5:if(!(l<j.length)){v.next=38;break}m=j[l];o=g[m];if(o.unique){v.next=10;break}return v.abrupt("continue",35);case 10:p=n(o.keyIds);if(!h.has(p)){v.next=13;break}return v.abrupt("continue",35);case 13:h.add(p);r=s(d,f,m);if(!(r==null)){v.next=17;break}return v.abrupt("continue",35);case 17:t=i.indexes[m].getWithDefault(r,k);if(!(t!==k)){v.next=30;break}v.t0=t!=null&&t.state==="addedOrUnmodified";if(!v.t0){v.next=25;break}v.next=23;return b("nativePromiseRegeneratorRuntime").awrap(A(d,t));case 23:v.t1=v.sent.state,v.t0=v.t1==="unmodified";case 25:if(!v.t0){v.next=27;break}t=i.indexes[m].get(r);case 27:if(!(t==null||t.value==null||c(s(d,t.value),e)===0)){v.next=29;break}return v.abrupt("continue",35);case 29:return v.abrupt("return",!1);case 30:v.next=32;return b("nativePromiseRegeneratorRuntime").awrap(a.table(d).index(m).getKey(r));case 32:u=v.sent;if(!(u!=null&&c(u,e)!==0)){v.next=35;break}return v.abrupt("return",!1);case 35:l++;v.next=5;break;case 38:return v.abrupt("return",!0);case 39:case"end":return v.stop()}},null,this)}function A(c,d){var e,f,h;return b("nativePromiseRegeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:if(!(d.state==="addedOrUnmodified")){i.next=8;break}d.value!=null||g(0,8630);e=b("nullthrows")(s(c,d.value));i.next=5;return b("nativePromiseRegeneratorRuntime").awrap(a.table(c).get(e));case 5:f=i.sent;h=y(c);return i.abrupt("return",f!=null?h.set(e,{state:"unmodified",value:f},d.value):h.set(e,{state:"added",value:d.value}));case 8:return i.abrupt("return",d);case 9:case"end":return i.stop()}},null,this)}function B(a,d,e,g){var h,i,j,k,l,m,n,o,p,q,r,t,u,v,w;return b("nativePromiseRegeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:h=b("nullthrows")({asc:1,desc:-1}[g]);f.next=3;return b("nativePromiseRegeneratorRuntime").awrap(a.next());case 3:i=f.sent,j=d.next();case 5:k=void 0;if(!i.done){f.next=21;break}case 8:if(j.done){f.next=20;break}l=j.value,m=l[0],n=l[1];if(!(n!=null&&n.value!=null)){f.next=16;break}f.next=13;return[m,n.value];case 13:k=f.sent;f.next=17;break;case 16:k=void 0;case 17:j=d.next(k);f.next=8;break;case 20:return f.abrupt("return");case 21:if(!j.done){f.next=32;break}case 22:if(i.done){f.next=31;break}f.next=25;return i.value;case 25:k=f.sent;f.next=28;return b("nativePromiseRegeneratorRuntime").awrap(a.next(k));case 28:i=f.sent;f.next=22;break;case 31:return f.abrupt("return");case 32:o=j.value,p=o[0],q=o[1];r=i,t=r.value,u=t[0],v=t[1];w=c(u,p)*h;if(!(w<0)){f.next=45;break}f.next=38;return[u,v];case 38:k=f.sent;f.next=41;return b("nativePromiseRegeneratorRuntime").awrap(a.next(k));case 41:i=f.sent;k!==void 0&&c(k,p)*h>0&&(j=d.next(k));f.next=75;break;case 45:if(!(w===0)){f.next=64;break}if(!(q!=null)){f.next=58;break}if(!(q.state==="addedOrUnmodified")){f.next=54;break}y(e).set(b("nullthrows")(s(e,v)),{state:"unmodified",value:v});f.next=51;return[u,v];case 51:k=f.sent;f.next=58;break;case 54:if(!(q.value!=null)){f.next=58;break}f.next=57;return[p,q.value];case 57:k=f.sent;case 58:f.next=60;return b("nativePromiseRegeneratorRuntime").awrap(a.next(k));case 60:i=f.sent;j=d.next(k);f.next=75;break;case 64:if(!(q!=null)){f.next=70;break}q.state==="addedOrUnmodified"&&y(e).set(b("nullthrows")(s(e,b("nullthrows")(q.value))),{state:"added",value:q.value});if(!(q.value!=null)){f.next=70;break}f.next=69;return[p,q.value];case 69:k=f.sent;case 70:j=d.next(k);if(!(k!==void 0&&c(k,u)*h>0)){f.next=75;break}f.next=74;return b("nativePromiseRegeneratorRuntime").awrap(a.next(k));case 74:i=f.sent;case 75:f.next=5;break;case 77:case"end":return f.stop()}},f,this)}var C={table:function(d){function e(a){var b=q.tableNames[d],c={},e=0;while(a!==0)c[b.primaryKeyIds[e]]=a[0],a=a[1],e++;return c}function f(a,b){j.push([d,a,b]),r.notifyTableAndIndexSubscribers(d,a,b,new WeakMap())}function h(a,c){var e,f,g,h,i,j,k,l,m,n;return b("nativePromiseRegeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:e=function(a,b){var c=[],d=a;while(d!==0)c.push(d[0]),d=d[1];return c.length>=b?a:c.reduceRight(function(a,b){return[b,a]},[[[]],0])},(f=q.tableNames[d],g=f.cascadeUpdates,h=f.primaryKeyIds),i=function(){var f,g,d,i,n,o,p,r,t,u,v,w,x,y,z;return b("nativePromiseRegeneratorRuntime").async(function(A){while(1)switch(A.prev=A.next){case 0:if(!k){A.next=6;break}if(!(l>=j.length)){A.next=3;break}return A.abrupt("return","break");case 3:m=j[l++];A.next=10;break;case 6:l=j.next();if(!l.done){A.next=9;break}return A.abrupt("return","break");case 9:m=l.value;case 10:f=m;g=f.indexName;d=f.tableName;i=q.tableNames[d],n=i.indexes,o=i.primaryKeyIds;p=g==null?o:n[g].keyIds;r={gte:a,lte:e(a,p.length)};t=(g==null?C.table(d):C.table(d).index(g)).entries(new WeakMap(),"asc",r);A.next=19;return b("nativePromiseRegeneratorRuntime").awrap(t.next());case 19:u=A.sent,v=[];case 21:if(u.done){A.next=28;break}v.push(u.value);A.next=25;return b("nativePromiseRegeneratorRuntime").awrap(t.next());case 25:u=A.sent;A.next=21;break;case 28:w=0;case 29:if(!(w<v.length)){A.next=44;break}x=v[w];x[0];y=x[1];z=b("nullthrows")(s(d,y));if(!(c===void 0)){A.next=39;break}A.next=37;return b("nativePromiseRegeneratorRuntime").awrap(C.table(d)["delete"](z));case 37:A.next=41;break;case 39:A.next=41;return b("nativePromiseRegeneratorRuntime").awrap(C.table(d).upsert(z,h.reduce(function(a,b,c){b=a[0];a=a[1];b[p[c]]=a[0];return[b,a[1]]},[babelHelpers["extends"]({},y),c])[0]));case 41:w++;A.next=29;break;case 44:case"end":return A.stop()}},null,this)},(j=g,k=Array.isArray(j),l=0,j=k?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 4:o.next=6;return b("nativePromiseRegeneratorRuntime").awrap(i());case 6:n=o.sent;if(!(n==="break")){o.next=9;break}return o.abrupt("break",11);case 9:o.next=4;break;case 11:case"end":return o.stop()}},null,this)}return{add:function(a){var c,e,g,h,i,j,k,n;return b("nativePromiseRegeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:if(!w){o.next=2;break}throw new p();case 2:c=q.tableNames[d],e=c.autoIncrement,g=c.primaryKeyIds;h=m(a);i=y(d);if(!e){o.next=9;break}o.next=8;return b("nativePromiseRegeneratorRuntime").awrap(i.nextAutoIncrementId());case 8:h[g[0]]=o.sent;case 9:j=b("nullthrows")(s(d,h));o.next=12;return b("nativePromiseRegeneratorRuntime").awrap(z(d,j,a));case 12:if(o.sent){o.next=14;break}u(l("while adding",d,j,a));case 14:k={state:"addedOrUnmodified",value:h};n=i.getWithDefault(j);if(!(n!==void 0)){o.next=20;break}if(!(n.value!=null)){o.next=19;break}return o.abrupt("return");case 19:k.state="upserted";case 20:f(void 0,k.value),i.set(j,k);case 22:case"end":return o.stop()}},null,this)},"delete":function(a){var c,g;return b("nativePromiseRegeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:if(!w){i.next=2;break}throw new p();case 2:c=y(d);if(!t[d].length){i.next=9;break}i.next=6;return b("nativePromiseRegeneratorRuntime").awrap(C.table(d).get(a));case 6:i.t0=i.sent;i.next=10;break;case 9:i.t0=e(a);case 10:g=i.t0;i.next=13;return b("nativePromiseRegeneratorRuntime").awrap(h(a));case 13:f(g,void 0),c.set(a,{state:"deleted",value:void 0},g);case 15:case"end":return i.stop()}},null,this)},entries:function(b,c,e){c===void 0&&(c="asc");e===void 0&&(e={});if(w)throw new p();return B(a.table(d).entries(b,c,e),y(d).entities.entries(babelHelpers["extends"]({},e,{dir:c})),d,"asc")},get:function(c){var e,f;return b("nativePromiseRegeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:if(!w){g.next=2;break}throw new p();case 2:e=y(d);f=e.getWithDefault(c);if(!(f===void 0)){g.next=10;break}g.next=7;return b("nativePromiseRegeneratorRuntime").awrap(a.table(d).get(c));case 7:f=g.sent;e.set(c,{state:"unmodified",value:f});return g.abrupt("return",f);case 10:g.next=12;return b("nativePromiseRegeneratorRuntime").awrap(A(d,f));case 12:return g.abrupt("return",g.sent.value);case 13:case"end":return g.stop()}},null,this)},index:function(e){return{entries:function(b,c,f){c===void 0&&(c="asc");f===void 0&&(f={});if(w)throw new p();return B(a.table(d).index(e).entries(b,c,f),y(d).indexes[e].entries(babelHelpers["extends"]({},f,{dir:c})),d,c)},get:function(f){var h,i,j,l,m;return b("nativePromiseRegeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:if(!w){n.next=2;break}throw new p();case 2:h=y(d);i=h.indexes[e];i!=null||g(0,19687);j=i.getWithDefault(f,k);if(!(j===k)){n.next=15;break}n.next=9;return b("nativePromiseRegeneratorRuntime").awrap(a.table(d).index(e).get(f));case 9:l=n.sent;if(!(l==null)){n.next=13;break}i.set(f,void 0);return n.abrupt("return",void 0);case 13:j={state:"unmodified",value:l},h.set(b("nullthrows")(s(d,l)),j);case 15:if(!(j==null)){n.next=17;break}return n.abrupt("return",void 0);case 17:n.next=19;return b("nativePromiseRegeneratorRuntime").awrap(A(d,j));case 19:m=n.sent.value;if(!(m==null||c(s(d,m,e),f)!==0)){n.next=22;break}return n.abrupt("return",void 0);case 22:return n.abrupt("return",m);case 23:case"end":return n.stop()}},null,this)},getKey:function(a){var c;return b("nativePromiseRegeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:if(!w){f.next=2;break}throw new p();case 2:f.next=4;return b("nativePromiseRegeneratorRuntime").awrap(C.table(d).index(e).get(a));case 4:c=f.sent;return f.abrupt("return",c==null?void 0:s(d,c));case 6:case"end":return f.stop()}},null,this)},subscribe:function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return r.subscribeIndex.apply(r,[d,e].concat(b))}}},peekNextAutoIncrementId:function(){return b("nativePromiseRegeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:return a.abrupt("return",y(d).nextAutoIncrementId());case 1:case"end":return a.stop()}},null,this)},put:function(a){var c,g,i;return b("nativePromiseRegeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:if(!w){j.next=2;break}throw new p();case 2:c=y(d);g=b("nullthrows")(s(d,a));if(!t[d].length){j.next=10;break}j.next=7;return b("nativePromiseRegeneratorRuntime").awrap(C.table(d).get(g));case 7:j.t0=j.sent;j.next=11;break;case 10:j.t0=e(g);case 11:i=j.t0;j.next=14;return b("nativePromiseRegeneratorRuntime").awrap(h(g));case 14:c.set(g,{state:"deleted",value:void 0},i);j.next=17;return b("nativePromiseRegeneratorRuntime").awrap(z(d,g,a));case 17:if(j.sent){j.next=19;break}u(l("while performing replace",d,g,a));case 19:f(i,a),c.set(g,{state:"upserted",value:a},i);case 21:case"end":return j.stop()}},null,this)},subscribe:function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return r.subscribeTable.apply(r,[d].concat(b))},upsert:function(a,c){var g,j,k;return b("nativePromiseRegeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:if(!w){m.next=2;break}throw new p();case 2:g=y(d);j=b("nullthrows")(s(d,c));if(!t[d].length){m.next=10;break}m.next=7;return b("nativePromiseRegeneratorRuntime").awrap(C.table(d).get(a));case 7:m.t0=m.sent;m.next=11;break;case 10:m.t0=e(a);case 11:k=m.t0;if(i(a,j)){m.next=16;break}m.next=15;return b("nativePromiseRegeneratorRuntime").awrap(h(a,j));case 15:g.set(a,{state:"deleted",value:void 0},k);case 16:m.next=18;return b("nativePromiseRegeneratorRuntime").awrap(z(d,j,c));case 18:if(m.sent){m.next=20;break}u(l("while performing upsert",d,a,c));case 20:f(k,c),g.set(j,{state:"upserted",value:c},k);case 22:case"end":return m.stop()}},null,this)}}}};return new Promise(function(c,e){o=o.then(function(){var f;return b("nativePromiseRegeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.prev=0;g.next=3;return b("nativePromiseRegeneratorRuntime").awrap(Promise.race([d(C),v]));case 3:f=g.sent;g.next=6;return b("nativePromiseRegeneratorRuntime").awrap(a.flushWrites(j));case 6:c(f);g.next=12;break;case 9:g.prev=9,g.t0=g["catch"](0),e(g.t0);case 12:g.prev=12;w=!0;r.dispose();return g.finish(12);case 16:case"end":return g.stop()}},null,this,[[0,9,12,16]])})})};e.exports.TransactionClosedError=p}),null);
__d("LSTransaction.bs",["LSTransaction","IndexedDbKeyComparer"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d){return b("LSTransaction")(a,b("IndexedDbKeyComparer"),c,function(){switch(d){case-240492574:return"readonly";case 557889961:return"readwrite"}}())}f.run=a}),null);
__d("LSDatabaseType.bs",[],(function(a,b,c,d,e,f){"use strict";a=[0,0];b=[0,1];c=[0,2];d=[0,3];e=[0,4];var g=[0,5],h=[0,6],i=[0,7],j=[0,8],k=[0,9],l=[0,10],m=[0,11],n=[0,12],o=[0,13],p=[0,14],q=[0,15],r=[0,16],s=[0,17],t=[0,18],u=[0,19],v=[0,20],w=[0,21],x=[0,22],y=[0,23],z=[0,24],A=[0,25],B=[0,26],C=[0,27],D=[0,28],E=[0,29],F=[0,30],G=[0,31],H=[0,32],I=[0,33],J=[0,34],K=[0,35],L=[0,36],M=[0,37],N=[0,38],O=[0,39],P=[0,40],Q=[0,41],R=[0,42],S=[0,43],T=[0,44],U=[0,45],V=[0,46],W=[0,47],X=[0,48],Y=[0,49],Z=[0,50],$=[0,51],aa=[0,52],ba=[0,53],ca=[0,54],da=[0,55],ea=[0,56],fa=[0,57],ga=[0,59],ha=[0,60],ia=[0,61],ja=[0,62],ka=[0,63],la=[0,64],ma=[0,65],na=[0,66],oa=[0,67],pa=[0,68],qa=[0,69],ra=[0,70],sa=[0,71],ta=[0,72],ua=[0,73],va=[0,74],wa=[0,75],xa=[0,76];f.test=a;f.mailbox=b;f.contact=c;f.appAlerts=d;f.core=e;f.stories=g;f.presence=h;f.ranking=i;f.experiment=j;f.search=k;f.securemailbox=l;f.inboxAds=m;f.sticker=n;f.omnistoreRevisionTest=o;f.frx=p;f.payments=q;f.settings=r;f.gif=s;f.arEffects=t;f.platformExtensionSdk=u;f.businessTab=v;f.composerMenus=w;f.experimentalContactPhoneNumber=x;f.forwardContents=y;f.typing=z;f.qp=A;f.inthreadbanner=B;f.logSampling=C;f.threadTheme=D;f.mediaSend=E;f.contactUpload=F;f.aloha=G;f.omnistoreSimpleTest=H;f.booking=I;f.oneTimeSyncTest=J;f.threadEmoji=K;f.universalLinks=L;f.counters=M;f.emptyTest=N;f.accountSettings=O;f.videoChatLink=P;f.zeroRating=Q;f.connectivity=R;f.switchAccountBadging=S;f.emergencyPoll=T;f.cowatch=U;f.switchAccountProfiles=V;f.$$location=W;f.syncWatchdog=X;f.bloks=Y;f.mediaEditing=Z;f.pushNotifications=$;f.switchAccountBadgingRealtime=aa;f.dasmDebug=ba;f.testTwo=ca;f.dataTrace=da;f.mediaSharing=ea;f.pluginExtensions=fa;f.localUserSettings=ga;f.groups=ha;f.dabl=ia;f.linkedGroups=ja;f.fxcal=ka;f.rooms=la;f.proactiveWarnings=ma;f.messagingAds=na;f.supportInbox=oa;f.coreClient=pa;f.threadCoPresence=qa;f.marketplace=ra;f.carrierMessaging=sa;f.notificationsClient=ta;f.cat=ua;f.composerSettings=va;f.groupThreadImage=wa;f.coplayMetadata=xa}),null);
__d("MWLSSchemaEphemeral.bs",["Promise","LSTransaction.bs","MPWLSDBCreateSchema.bs","LSJSTestMemoryStorage.bs","MWLSDatabaseInitialData.bs"],(function(a,b,c,d,e,f){"use strict";function a(a){return b("Promise").resolve(b("LSJSTestMemoryStorage.bs").make(b("MPWLSDBCreateSchema.bs").metadata)).then(function(a){return b("LSTransaction.bs").run(a,b("MWLSDatabaseInitialData.bs").run,557889961).then(function(b){return a})})}f.createDB=a}),null);